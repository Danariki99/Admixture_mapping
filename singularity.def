Bootstrap: docker
From: python:3.8.20

%labels
    Author YourName
    Version v1.1

%environment
    export LC_ALL=C.UTF-8
    export LANG=C.UTF-8
    export PYTHONDONTWRITEBYTECODE=1
    export PYTHONUNBUFFERED=1

%post

    apt-get update && apt-get install -y bcftools



    echo "ðŸ”§ Toolchain scientifico..."
    apt-get update && apt-get install -y \
        build-essential \
        gcc \
        gfortran \
        libopenblas-dev \
        liblapack-dev \
        git \
        curl \
        wget \
        unzip \
        bzip2 \
        ca-certificates \
        make \
        zlib1g-dev \
        libbz2-dev \
        liblzma-dev \
        libcurl4-openssl-dev \
        libssl-dev \
        && rm -rf /var/lib/apt/lists/*
    
    pip install --upgrade pip


    pip install \
        matplotlib==3.3.4 \
        numpy==1.20.3 \
        pandas==1.3.5 \
        PyYAML==5.1.2 \

    pip install --no-deps \
        scikit-allel==1.3.1 \

    pip install \
        scikit-learn==1.0.1 \
        scipy==1.5.3 \
        seaborn==0.11.2 \
        sklearn-crfsuite==0.3.6 \
        tqdm==4.62.3 \
        uncertainty-calibration==0.1.4 \
        xgboost==1.1.1 \
        requests==2.32.3 \
        Pillow==9.5.0 \
        snputils==0.2.11 \
    
    echo "ðŸ“¦ Installa librerie di sistema per R..."
apt-get update && apt-get install -y --no-install-recommends \
    software-properties-common \
    dirmngr \
    wget \
    gnupg \
    libcurl4-openssl-dev \
    libssl-dev \
    libxml2-dev

echo "ðŸ“¦ Installa R base (dal repo Debian, senza repo CRAN esterno)..."
apt-get update && apt-get install -y r-base

echo "ðŸ“¦ Installa pacchetti R..."
Rscript -e 'install.packages("BiocManager", repos="https://cloud.r-project.org")'
Rscript -e 'BiocManager::install(version = "3.16")'
Rscript -e 'BiocManager::install("biomaRt")'
Rscript -e 'install.packages(c("data.table", "optparse"), repos="https://cloud.r-project.org")'



%runscript
    echo "âœ… Container pronto!"
    exec "$@"
